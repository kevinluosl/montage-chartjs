montageDefine("b14c684","core/core",{dependencies:["collections/shim","./shim/object","./shim/array","./shim/string","./extras/object","./extras/date","./extras/element","./extras/function","./extras/regexp","./extras/string","./deprecate","./uuid","collections/listen/property-changes","frb","collections/weak-map","collections/map","frb/parse","frb/evaluate","frb/assign","frb/observe","frb/bind","frb/compile-observer","frb/scope","frb/observers","./serialization/bindings","./promise"],factory:function(t,e){function i(t,e){var a=s+e+n;return t.hasOwnProperty(a)?t[a]:Object.defineProperty(t,a,{enumerable:!1,configurable:!1,writable:!0,value:Object.create(i(Object.getPrototypeOf(t),e))})[a]}t("collections/shim"),t("./shim/object"),t("./shim/array"),t("./shim/string"),t("./extras/object"),t("./extras/date"),t("./extras/element"),t("./extras/function"),t("./extras/regexp"),t("./extras/string");var a=t("./deprecate"),n="AttributeProperties",s="_",l="__proto__",o="value",r="enumerable",c="distinct",h="serializable",p=Array.prototype,d=Object.prototype,g=!0,u=e.Montage=function u(){};u.deprecate=a.deprecateMethod(u,a.deprecateMethod,"Montage.deprecate","deprecate module's deprecateMethod"),u.callDeprecatedFunction=a.deprecateMethod(u,a.callDeprecatedFunction,"Montage.callDeprecatedFunction","deprecate module's callDeprecatedFunction");var m={}.__proto__===Object.prototype,f={_montage_metadata:1,__state__:1},v=Object.getOwnPropertyNames(Function);if(Object.defineProperty(u,"specialize",{value:function(t,e){var i,n,s,l,o,r,c,h=this,p=this.specialize===void 0;if(t=t||Object.empty,e=e||Object.empty,i=t.constructor&&t.constructor.value?t.constructor.value:t.didCreate&&t.didCreate.value?u.deprecate(null,t.didCreate.value,"didCreate","constructor"):function(){return this.superForValue("constructor")()||this},m)i.__proto__=h;else{s=Object.getOwnPropertyNames(h);for(var r=0;s.length>r;r++)l=s[r],f.hasOwnProperty(l)||(o=Object.getOwnPropertyDescriptor(i,l),(!o||o.configurable)&&u.defineProperty(i,l,Object.getOwnPropertyDescriptor(h,l)));i.__constructorProto__=h,u.defineProperty(i,"isPrototypeOf",{value:function(t){for(;null!==t;){if(Object.getPrototypeOf(t)===this)return!0;t=Object.getPrototypeOf(t)}return!1},enumerable:!1})}if(n=Object.create(this.prototype),p){for(s=Object.getOwnPropertyNames(u),r=0;s.length>r;r++)l=s[r],o=Object.getOwnPropertyDescriptor(i,l),(!o||o.configurable)&&u.defineProperty(i,l,Object.getOwnPropertyDescriptor(u,l));for(s=Object.getOwnPropertyNames(u.prototype),r=0;s.length>r;r++)l=s[r],o=Object.getOwnPropertyDescriptor(i,l),(!o||o.configurable)&&u.defineProperty(n,l,Object.getOwnPropertyDescriptor(u.prototype,l))}if(u.defineProperties(n,t),g){c=function(t,e,i){function n(){return this===e&&a.deprecationWarning(u.getInfoForObject(e).objectName+"."+i+" should be moved to constructorProperties",null,3),t.apply(this,arguments)}return n.deprecatedFunction=t,n};for(l in t)v.has(l)?delete t[l]:(o=t[l],o.value&&"function"==typeof o.value&&!o.value.__isConstructor__?o.value=c(o.value,i,l):(o.get&&(o.get=c(o.get,i,l)),o.set&&(o.set=c(o.set,i,l))));u.defineProperties(i,t),u.defineProperty(i,"create",{value:function(){return new i},enumerable:!1})}return u.defineProperties(i,e),u.defineProperty(i,"__isConstructor__",{value:!0,enumerable:!1}),u.defineProperty(i,"_superCache",{value:{},enumerable:!1}),i.prototype=n,u.defineProperty(n,"constructor",{value:i,enumerable:!1}),i},writable:!0,configurable:!0,enumerable:!1}),!m){var L=Object.getPrototypeOf;Object.getPrototypeOf=function(t){return"function"==typeof t&&t.__constructorProto__?t.__constructorProto__:L.apply(Object,arguments)}}Object.defineProperty(u,"create",{configurable:!0,value:function(t,e){if(void 0!==t&&"object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object prototype may only be an Object or null, not '"+t+"'");if(t=t===void 0?this:t,"function"==typeof t)return e?t.specialize(e):new t;var i=Object.create(t);return e&&u.defineProperties(i,e),i}});var C=[h];C.forEach(function(t){Object.defineProperty(Object.prototype,s+t+n,{enumerable:!1,configurable:!1,writable:!0,value:{}})}),Object.defineProperty(u,"defineProperty",{value:function(t,e,a){if("object"!=typeof t&&"function"!=typeof t||null===t)throw new TypeError("Object must be an object, not '"+t+"'");var n=o in a;if(c in a&&!n)throw new TypeError("Cannot use distinct attribute on non-value property '"+e+"'");if(l in a)a.__proto__=n?"function"==typeof a.value?M:w:x;else{var g;g=n?"function"==typeof a.value?M:w:x;for(var u in g)u in a||(a[u]=g[u])}if(a.hasOwnProperty(r)||e.charAt(0)!==s||(a.enumerable=!1),a.hasOwnProperty(h)||(a.enumerable?a.get&&!a.set?a.serializable=!1:a.writable===!1&&(a.serializable=!1):a.serializable=!1),h in a&&(i(t,h)[e]=a.serializable),a.distinct!==!0||"object"!=typeof a.value){var m,f,v;if(t._superDependencies){if("function"==typeof a.value&&(m=t._superDependencies[e+".value"]))for(f=0,v=m.length;v>f;f++)delete m[f]._superCache[e+".value"];if("function"==typeof a.get&&(m=t._superDependencies[e+".get"]))for(f=0,v=m.length;v>f;f++)delete m[f]._superCache[e+".get"];if("function"==typeof a.set&&(m=t._superDependencies[e+".set"]))for(f=0,v=m.length;v>f;f++)delete m[f]._superCache[e+".set"]}return Object.defineProperty(t,e,a)}(function(t,e,i,a){var n=function(t,e,i){Object.defineProperty(t,e,{enumerable:!1,configurable:!0,writable:!0,value:i})};i.constructor===Object&&Object.getPrototypeOf(i)===d?0!==Object.keys(i).length?Object.defineProperty(a,t,{configurable:!0,get:function(){var t=this[e];if(!t){var a;t={};for(a in i)t[a]=i[a];this.hasOwnProperty(e)?this[e]=t:n(this,e,t)}return t},set:function(t){this.hasOwnProperty(e)?this[e]=t:n(this,e,t)}}):Object.defineProperty(a,t,{configurable:!0,get:function(){var t=this[e];return t||(t={},this.hasOwnProperty(e)?this[e]=t:n(this,e,t)),t},set:function(t){this.hasOwnProperty(e)?this[e]=t:n(this,e,t)}}):(i.__proto__||Object.getPrototypeOf(i))===p?0!==i.length?Object.defineProperty(a,t,{configurable:!0,get:function(){var t=this[e];if(!t){var a,s;for(t=[],a=0;(s=i[a])!==void 0;a++)t[a]=s;this.hasOwnProperty(e)?this[e]=t:n(this,e,t)}return t},set:function(t){this.hasOwnProperty(e)?this[e]=t:n(this,e,t)}}):Object.defineProperty(a,t,{configurable:!0,get:function(){var t=this[e];return t||(t=[],this.hasOwnProperty(e)?this[e]=t:n(this,e,t)),t},set:function(t){this.hasOwnProperty(e)?this[e]=t:n(this,e,t)}}):i.constructor.prototype===Object.getPrototypeOf(i)?Object.defineProperty(a,t,{configurable:!0,get:function(){var t=this[e];if(!t){var a;t=new i.constructor;for(a in i)t[a]=i[a];this.hasOwnProperty(e)?this[e]=t:n(this,e,t)}return t},set:function(t){this.hasOwnProperty(e)?this[e]=t:n(this,e,t)}}):Object.defineProperty(a,t,{configurable:!0,get:function(){var t=this[e];return t||(t=Object.create(i.__proto__||Object.getPrototypeOf(i)),this.hasOwnProperty(e)?this[e]=t:n(this,e,t)),t},set:function(t){this.hasOwnProperty(e)?this[e]=t:n(this,e,t)}})})(e,s+e,a.value,t)}}),Object.defineProperty(u,"defineProperties",{value:function(t,e){if("object"!=typeof e||null===e)throw new TypeError("Properties must be an object, not '"+e+"'");for(var i in e)"_bindingDescriptors"!==i&&this.defineProperty(t,i,e[i]);return t}});var x={enumerable:!0,configurable:!0,serializable:!0},w={writable:!0,enumerable:!0,configurable:!0,serializable:"reference"},M={writable:!0,enumerable:!1,configurable:!0,serializable:!1};u.defineProperty(u,"didCreate",{value:Function.noop});var y=function(t,e){var i,a,n,s,l,o,r,c,h;if(!e._superPropertyName||!e._superPropertyType)for(u.defineProperty(e,"_superPropertyType",{value:null}),u.defineProperty(e,"_superPropertyName",{value:null}),r=t;!c&&null!==r;){for(i=Object.getOwnPropertyNames(r),a=Object.getPrototypeOf(r),n=0,s=i.length,n;s>n;n++){if(l=i[n],h=Object.getOwnPropertyDescriptor(r,l),null!=(o=h.value)&&(o===e||o.deprecatedFunction===e)){e._superPropertyType="value",e._superPropertyName=l,c=!0;break}if(null!=(o=h.get)&&(o===e||o.deprecatedFunction===e)){e._superPropertyType="get",e._superPropertyName=l,c=!0;break}if(null!=(o=h.set)&&(o===e||o.deprecatedFunction===e)){e._superPropertyType="set",e._superPropertyName=l,c=!0;break}}r=a}return b(t,e._superPropertyType,e._superPropertyName)},z=function(){if("function"!=typeof z.caller)throw new TypeError("Can't get super without caller. Use this.superForValue(methodName) if using strict mode.");var t=y(this,z.caller);return"function"==typeof t?t.bind(this):Function.noop},b=function(t,e,i){var a,n,s,l,o,r=t,c=i+"."+e;if(t._superContext||u.defineProperty(t,"_superContext",{value:{}}),t._superContext[c])r=t._superContext[c];else for(r=t;null!==r&&(!r.hasOwnProperty(i)||(s=Object.getOwnPropertyDescriptor(r,i),"function"!=typeof s[e]));)r=Object.getPrototypeOf(r);if(l=r.constructor,l._superCache&&l._superCache[c])return o=function(t,e,i,a){return function(){e._superContext[t]=i;var n=a.apply(e,arguments);return delete e._superContext[t],n}}(c,t,l._superCache[c].owner,l._superCache[c].func);for(n=r;a===void 0&&(n=Object.getPrototypeOf(n));)if(n._superDependencies||u.defineProperty(n,"_superDependencies",{value:{}}),n._superDependencies[c]||(n._superDependencies[c]=[]),n._superDependencies[c].push(l),s=Object.getOwnPropertyDescriptor(n,i)){if("function"==typeof s[e]){a=s[e];break}break}return"function"==typeof a?(o=function(t,e,i,a){return function(){e._superContext[t]=i;var n=a.apply(e,arguments);return delete e._superContext[t],n}}(c,t,n,a),l._superCache||u.defineProperty(l,"_superCache",{value:{}}),l._superCache[c]={func:a,owner:n},o):Function.noop},S=function(t){return b(this,"value",t)},_=function(t){return b(this,"get",t)},P=function(t){return b(this,"set",t)};u.defineProperty(u,"super",{get:z,enumerable:!1}),u.defineProperty(u.prototype,"super",{get:z,enumerable:!1}),u.defineProperty(u,"superForValue",{value:S,enumerable:!1}),u.defineProperty(u.prototype,"superForValue",{value:S,enumerable:!1}),u.defineProperty(u,"superForGet",{value:_,enumerable:!1}),u.defineProperty(u.prototype,"superForGet",{value:_,enumerable:!1}),u.defineProperty(u,"superForSet",{value:P,enumerable:!1}),u.defineProperty(u.prototype,"superForSet",{value:P,enumerable:!1}),u.defineProperty(u,"getSerializablePropertyNames",{value:function(t){var e=[],i=t._serializableAttributeProperties;if(i)for(var a in i)i[a]&&e.push(a);return e}}),u.defineProperty(u,"getPropertyAttribute",{value:function(t,e,i){var a=s+i+n,l=t[a];return l?l[e]:void 0}}),u.defineProperty(u,"getPropertyAttributes",{value:function(t,e){var i={},a=s+e+n,l=t[a];if(l){for(var o in l)i[o]=l[o];return i}}});var B={isInstance:{value:!0}},T={objectName:{value:"Function"},isInstance:{value:!0}};u.defineProperty(u,"getInfoForObject",{value:function(t){var e,i;if(D.call(t,"_montage_metadata"))return t._montage_metadata;if(e=t._montage_metadata||t.constructor&&t.constructor._montage_metadata||null,i=t.constructor===Function?T:B,t===Object.prototype)return Object.create(e,i);try{return Object.defineProperty(t,"_montage_metadata",{enumerable:!1,writable:!0,value:Object.create(e,i)})._montage_metadata}catch(a){return t._montage_metadata=Object.create(e,i)}}});var k=t("./uuid");"undefined"!=typeof window&&(window.uuid=k.generate());var D=Object.prototype.hasOwnProperty,A=function(){var t=k.generate(),e=u.getInfoForObject(this);try{null!==e&&e.isInstance===!1?(this._uuid=t,Object.defineProperty(this,"uuid",{get:function(){return this.hasOwnProperty("uuid")?this._uuid:A.call(this)}})):(e.isInstance&&Object.defineProperty(this,"uuid",{configurable:!0,enumerable:!1,writable:!1,value:t}),!(this instanceof Element)&&e.isInstance&&o in(Object.getOwnPropertyDescriptor(this,"uuid")||{})&&l in this||(this._uuid=t))}catch(i){}return this._uuid=t,t},E=function E(){return D.call(this,"_uuid")?this._uuid:A.call(this)};Object.defineProperty(Object.prototype,"_uuid",{enumerable:!1,value:null,writable:!0}),Object.defineProperty(Object.prototype,"uuid",{configurable:!0,get:E,set:function(){}}),u.defineProperty(u,"identifier",{value:null,serializable:!0}),u.defineProperty(u.prototype,"identifier",{value:null,serializable:!0}),u.defineProperty(u.prototype,"equals",{value:function(t){return t?this===t||this.uuid===t.uuid:!1}}),u.defineProperty(u,"equals",{value:u.prototype.equals}),u.defineProperty(u.prototype,"callDelegateMethod",{value:function(t){var e,i,a=this.delegate;return"string"==typeof this.identifier&&(e=this.identifier+t.toCapitalized(),a&&"function"==typeof(i=a[e]))?(p.shift.call(arguments),i.apply(a,arguments)):a&&"function"==typeof(i=a[t])?(p.shift.call(arguments),i.apply(a,arguments)):void 0}});var F=t("collections/listen/property-changes");Object.addEach(u,F.prototype),Object.addEach(u.prototype,F.prototype);var O=e.Bindings=t("frb"),R={defineBinding:{value:function(t,e,i){return O.defineBinding(this,t,e,i)}},defineBindings:{value:function(t,e){return O.defineBindings(this,t,e)}},cancelBinding:{value:function(t){return O.cancelBinding(this,t)}},cancelBindings:{value:function(){return O.cancelBindings(this)}},getBinding:{value:function(t){return O.getBinding(this,t)}},getBindings:{value:function(){return O.getBindings(this)}}};u.defineProperties(u,R),u.defineProperties(u.prototype,R);var I=t("collections/weak-map"),W=t("collections/map"),Y=t("frb/parse"),X=t("frb/evaluate"),N=t("frb/assign");t("frb/observe"),t("frb/bind");var H=t("frb/compile-observer"),j=t("frb/scope"),V=t("frb/observers"),Z=V.autoCancelPrevious,q=new I,G={getPath:{value:function(t,e,i,a){return X(t,this,e||this,i,a)}},setPath:{value:function(t,e,i,a,n){return N(this,t,e,i||this,a,n)}},observePath:{value:function(t,e){var i=Y(t),a=H(i);return a(Z(e),new j(this))}},addRangeAtPathChangeListener:{value:function(t,e,i,a,n,s){function l(t,a,n){if(e[i])e[i](t,a,n);else{if(!e.call)throw Error("Can't dispatch range change to "+e);e.call(null,t,a,n)}}i=i||"handleRangeChange";var o=[];return this.addPathChangeListener(t,function(t){return t&&t.toArray&&t.addRangeChangeListener?(l(t.toArray(),o.toArray(),0),o=t,t.addRangeChangeListener(l)):(t=[],l(t,o,0),o=t,void 0)},void 0,void 0,a,n,s)}},getPathChangeDescriptors:{value:function(){return q.has(this)||q.set(this,{}),q.get(this)}},getPathChangeDescriptor:{value:function(t,e,i){var a=u.getPathChangeDescriptors.call(this);return Object.owns(a,t)||(a[t]={willChangeListeners:new W,changeListeners:new W}),a=a[t],a=i?a.willChangeListeners:a.changeListeners,a.has(e)||a.set(e,{path:t,handler:e,beforeChange:i,cancel:Function.noop}),a.get(e)}},addPathChangeListener:{value:function(t,e,i,a,n,s,l){var o=this;e=e||Function.noop;var r=u.getPathChangeDescriptor.call(this,t,e,a);r.cancel();var c,h,p,d=Y(t);if(e===Function.noop)p=function(e){if(h)throw Error("Path change handler needs a handler because it emits new values when the source changes: "+JSON.stringify(t));h=!0,c=e};else if(i)p=function(a){return e[i].call(e,a,t,o)};else if(e.handlePathChange)p=function(i){return e.handlePathChange.call(e,i,t,o)};else{if("function"!=typeof e)throw Error("Can't recognize handler type: "+e+". Must be function or delegate implementing handlePathChange.");p=function(i){return e.call(o,i,t,o)}}var g=H(d),m=new j(this);m.beforeChange=a,m.parameters=n,m.document=s,m.components=l;var f=g(Z(p),m);return r.cancel=f,h?c:f}},removePathChangeListener:{value:function(t,e,i){e=e||Function.noop;var a=u.getPathChangeDescriptors.call(this),n=i?"willChangeListeners":"changeListeners";if(!Object.owns(a,t))throw Error("Can't find "+n+" for "+JSON.stringify(t));var s=a[t],l=s[n];if(!l.has(e))throw Error("Can't find "+n+" for "+JSON.stringify(t));var o=l.get(e);o.cancel(),l["delete"](e),0===s.willChangeListeners.length&&0===s.changeListeners.length&&delete a[t];for(var r in a)return;q["delete"](this)}},addBeforePathChangeListener:{value:function(t,e,i,a,n,s){return u.addPathChangeListener.call(this,t,e,i,!0,a,n,s)}},removeBeforePathChangeListener:{value:function(t,e){return u.removePathChangeListener.call(this,t,e,!0)}}};u.defineProperties(u,G),u.defineProperties(u.prototype,G),t("./serialization/bindings"),e._blueprintModuleIdDescriptor={serializable:!1,enumerable:!1,get:function(){var t=u.getInfoForObject(this),e=t&&!t.isInstance?this:this.constructor;if(!Object.getOwnPropertyDescriptor(e,"_blueprintModuleId")||!e._blueprintModuleId){t=u.getInfoForObject(e);var i=t.moduleId,a=i.lastIndexOf("/"),n=i.lastIndexOf(".");a=-1===a?0:a+1,n=-1===n?i.length:n,n=a>n?i.length:n,u.defineProperty(e,"_blueprintModuleId",{enumerable:!1,value:i.slice(0,n)+".meta"})}return e._blueprintModuleId}},e._blueprintDescriptor={serializable:!1,enumerable:!1,get:function(){var i=u.getInfoForObject(this),a=i&&!i.isInstance?this:this.constructor;if(!Object.getOwnPropertyDescriptor(a,"_blueprint")||!a._blueprint){var n=a.blueprintModuleId;if(""===n)throw new TypeError("Blueprint moduleId undefined for the module '"+JSON.stringify(a)+"'");e._blueprintDescriptor.BlueprintModulePromise||(e._blueprintDescriptor.BlueprintModulePromise=t.async("core/meta/module-blueprint").get("ModuleBlueprint")),u.defineProperty(a,"_blueprint",{enumerable:!1,value:e._blueprintDescriptor.BlueprintModulePromise.then(function(t){var e=u.getInfoForObject(a);return t.getBlueprintWithModuleId(n,e.require).fail(function(e){if(-1!==e.message.indexOf("Can't XHR"))return t.createDefaultBlueprintForObject(a).then(function(t){return t});throw e})})})}return a._blueprint},set:function(e){var i,a=u.getInfoForObject(this),n=a&&!a.isInstance?this:this.constructor;if(null===e)i=null;else{if("function"==typeof e.then)throw new TypeError("Object blueprint should not be a promise");e.blueprintInstanceModule=n.blueprintModule,i=t("./promise").Promise.resolve(e)}u.defineProperty(n,"_blueprint",{enumerable:!1,value:i})}}}});