var Bindings=require("frb"),parse=require("frb/parse"),stringify=require("frb/stringify"),expand=require("frb/expand"),Scope=require("frb/scope"),Serializer=require("../serialization").Serializer,Deserializer=require("../serialization").Deserializer;Serializer.defineSerializationUnit("bindings",function(t,e){var n,i=Bindings.getBindings(e),a={};for(var s in i){var r=i[s],o={};if(!("serializable"in r)||r.serializable){var l=r.sourcePath,c=r.sourceSyntax;if(r.source!==e){var h=t.getObjectLabel(r.source),u=new Scope({type:"component",label:h});u.components=t,c=expand(c,u)}var u=new Scope;u.components=t,l=stringify(c,u),r.twoWay?o["<->"]=l:o["<-"]=l,r.converter?o.converter=r.converter:(o.convert=r.convert,o.revert=r.revert),r.trace&&(o.trace=!0),a[s]=o,n=!0}}return n?a:void 0}),Deserializer.defineDeserializationUnit("bindings",function(t,e,n){for(var i in n){var a=n[i];if("object"!=typeof a)throw Error("Binding descriptor must be an object, not "+typeof a);"boundObject"in a?(a.source=t.getObjectByLabel(a.boundObject),a.oneway?a["<-"]=a.boundPropertyPath:a["<->"]=a.boundPropertyPath,delete a.boundObject,delete a.boundObjectPropertyPath,delete a.oneway):a["<<->"]&&(console.warn("WARNING: <<-> in bindings is deprectated, use <-> only, please update now."),a["<->"]=a["<<->"],delete a["<<->"])}Bindings.defineBindings(e,n,{components:t})});