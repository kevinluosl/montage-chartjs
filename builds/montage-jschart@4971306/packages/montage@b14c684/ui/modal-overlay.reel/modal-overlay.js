var Overlay=require("../overlay.reel").Overlay,Promise=require("../../core/promise").Promise,CLASS_PREFIX="montage-ModalOverlay";exports.ModalOverlay=Overlay.specialize({constructor:{value:function(){this.super()}},enterDocument:{value:function(t){var e;this.super(t),t&&(e=this.element.ownerDocument.body,e.appendChild(this.modalMaskElement))}},_queue:{value:[]},_showPromise:{value:null},_dismissOnExternalInteraction:{value:!1},hasModalMask:{value:!0},show:{value:function(){var t,e=this._queue,i=e.indexOf(this);return-1===i?(0===e.length?(this.super(),t=Promise.resolve()):(this._showPromise=Promise.defer(),t=this._showPromise.promise),e.push(this)):(0===i&&(this._showPromise=Promise.defer(),e.push(this)),t=this._showPromise.promise),t}},hide:{value:function(){var t,e=this._queue,i=e.indexOf(this);0===i?(e.shift(),this.super(),e.length>0&&(t=e[0],t._showPromise.resolve(),Overlay.prototype.show.call(t))):i>0&&(e.splice(i,1),this._showPromise.reject())}},draw:{value:function(){this.super(),this._isShown&&this.hasModalMask?this.modalMaskElement.classList.add(CLASS_PREFIX+"-modalMask--visible"):this.modalMaskElement.classList.remove(CLASS_PREFIX+"-modalMask--visible")}}});