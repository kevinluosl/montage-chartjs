montageDefine("b14c684","window-loader/montage-window",{dependencies:["../core/core"],factory:function(t,e){var n=t("../core/core").Montage;e.MontageWindow=n.specialize({_application:{value:null},application:{get:function(){return this._application},set:function(t){null===this._application&&(this._application=t,this.focused&&this._setFocusedWindow(this))}},_window:{value:null},window:{get:function(){return this._window},set:function(t){if(null===this._window){var e=t.document.body;this._window=t,t.addEventListener("beforeunload",this,!0),t.addEventListener("focus",this,!0),t.addEventListener("mousedown",this,!0),null===e.getAttribute("tabIndex")&&(e.setAttribute("tabIndex",-1),e.focus())}}},document:{get:function(){return this._window.document}},_component:{value:null},component:{get:function(){return this._component},set:function(t){null===this._component&&(this._component=t)}},title:{get:function(){return this.document.title},set:function(t){this.document.title=t}},focused:{value:!1},focus:{value:function(){this._window&&this._window.focus()}},_setFocusedWindow:{value:function(t){var e,n,i,a=this.application;if(a._multipleWindow){e=a.windows;for(i in e)n=e[i],n.window===t?n.focused!==!0&&(n.focused=!0,"z-order"==a.windowsSortOrder?(e.splice(i,1),e.unshift(n)):"reverse-z-order"==a.windowsSortOrder&&(e.splice(i,1),e.push(n))):n.focused=!1}else this.focused=!0}},closed:{get:function(){return this._window?this._window.closed:!1}},close:{value:function(){this._window&&this._window.close()}},resizeTo:{value:function(t,e){this._window&&this._window.resizeTo(t,e)}},moveTo:{value:function(t,e){this._window&&this._window.moveTo(t,e)}},captureFocus:{value:function(t){var e=this.application;if(!this.application)return this.focused=!0,void 0;if(e.parentApplication)e.mainApplication.window.captureFocus(t);else{var n=(t.target.ownerDocument?t.target.ownerDocument.defaultView:null)||t.target.defaultView||t.target;this._setFocusedWindow(n)}}},captureMousedown:{value:function(t){this.captureFocus(t)}},captureBeforeunload:{value:function(){var t,e=this.application,n=e.windows,i=e.attachedWindows;e.attachedWindows=[];for(var t in i)i[t].close();e.parentApplication&&(i=e.parentApplication.attachedWindows,t=i.indexOf(this),-1!==t&&i.splice(t,1),t=n.indexOf(this),-1!==t&&n.splice(t,1),this.window.removeEventListener("beforeunload",this,!0),this.close())}}})}});